
Описание разработки проекта

Структура проекта системы сбора для UNIX-подобных операционных систем

клиентский и серверные программы для UNIX-подобных операционных систем имеют общую базу исходного текста. Программы строятся по модульнуму принципу для урощения обслуживания, дальнейшей разработки и сопровождения програмного обеспечения. Модульный принцип построения обегчает восприятие и делает логику работы программ более прозрачной.

Структура серверной части

Серверная программа srv_mond ключает в себя:
1. модуль логики демона (сервиса, фонновая программа в UNIX-подобных операционных системах) включает в себя файл srv_mond.c
2. модуль сетевой логики. описывется в файлах srv_mond.c и protocol.h. модуль содержит описание протокола: необходимые для работы программ константы и включения заголовочных файлов, 
3. модуль агрегации данных и взаимодействия с базой данных mongodb_api.c
4. модуль идентификации описывается в файлах uuid.c и uuid.h, извлекает UUID сервера системы мониторинга.

Структура клиенской части

Клиентская программа client_mond ключает в себя:
1. модуль логики демона включает в себя файл clt_mond.c
2. модуль сетевой логики. описывется в файлах clt_mond.c и protocol.h. модуль содержит описание протокола: необходимые для работы программ константы и включения заголовочных файлов, 
3. модуль агрегации данных и взаимодействия с базой данных mongodb_api.c
4. модуль идентификации описывается в файлах uuid.c и uuid.h, извлекает UUID клиента системы мониторинга.

Описание общих модулей для клиента и сервера

Файл protocol.h
таблица *** Константы протокола
Имя	Значение	Описание
SERVER_PORT	2048	UDP порта сервера по умолчанию
SRV_CAST_RL	(tbf) {.rate = 1, .burst = 1}	Ограничение частоты многоадресной рассылки аннонсов сервером
CLT_SEND_RL	(tbf) {.rate = 1, .burst = 5}	Ограничение частоты отправки данных клиентом
MCAST_TTL	64	Время жизни в хопах сообщения многоадресной рассылки содержащей анонс
MCAST_ADDR	"239.0.0.1"	адрес назначения много адресной рассылки по умолчанию
MCAST_PORT	4092	UDP порт назначения многоадресной рассылки анонсов
SRV_LISTEN_T	3000	Время между отправкой анонсов в миллисекундах
ANS_TIMEOUT	5000	Время ожидания ответа сервера
MISED_ANS_COUNT_MAX	10	Максимальное количесво пропущенных подряд сообщений, по достижении этого значения клиент переходит в пассивный режим и ожидает анонс сервера для перехода в активный режим
CLIENT_PORT	2049	UDP порт назначения ответов сервера
IP4_STR_LEN	16	длина строки IP адреса
TIME_MAX	32	длина строки временного штампа

таблица *** Структура PC_stat
Тип поля	Имя поля	Описание
char	client_id[ID_LEN];	Строка содержащая UUID клиента
char	mac[LEN_MAC];	Строка содержащая MAC адрес клиента
char	IP[IP4_STR_LEN];	Строка содержащая IP адрес клиента
double	cpu_stat;	Число сплаваючей точкой двойной точности содержит текущее значение загруженности процессора в процентах
Memlist	mem_stat;	Поле содержит информацию об использовании оперативной мамяти на клиенском хосте
struct tm	time1;	Поле содержит временной штамп
char	time_str[TIME_MAX];	Срока содержит временной штамп
AVGList	avginfo;	Поле содержит информацию о средней загруженности центрального процессора за последние несколько минут

таблица *** Структура sk_t
Тип поля	Имя поля	Описание
int	s_in;	Сетевой файловый дескритор
struct sockaddr_in	LocalAddr;	Локальный адрес сетевого дескритпора
struct sockaddr_in	RemoteAddr;	Адрес назначения отправляемого сообщения
struct sockaddr_in	AnsAddr;	Адрес полученно ответа
int	snd_size;	Количество отправленных байт
char	IP[IP4_STR_LEN];	Строка IP адреса назначения
int	rcv_size;	Количество полученных байт
int	ans_code;	Код ответа удаленной стороны

Описание серверной части


